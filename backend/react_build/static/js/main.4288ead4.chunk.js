(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{111:function(e,t,a){e.exports=a(229)},145:function(e,t){},150:function(e,t){},152:function(e,t){},186:function(e,t){},187:function(e,t){},229:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),i=a(109),r=a.n(i),l=a(14),o=a(15),c=a(11),m=a(17),p=a(16),u=(a(116),a(110)),d=a.n(u),f=a(3),h=a.n(f),g=(a(41),function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"componentDidUpdate",value:function(){console.log(this.props)}},{key:"render",value:function(){var e=new Date(this.props.time),t=e.toLocaleDateString().split("/").slice(0,2).join("/");t+=" "+e.toLocaleTimeString().split(":").slice(0,2).join(":");var a="All"==this.props.filter||this.props.filter==this.props.name;return s.a.createElement("div",{className:"sen"==this.props.type?"bubble sen":"bubble",style:{display:a?"block":"none"}},s.a.createElement("div",{style:{fontWeight:"bold"}},"sen"==this.props.type&&s.a.createElement("span",{className:"material-icons",style:{fontSize:"1em"}},"keyboard_arrow_right"),this.props.name," | ",t," "),s.a.createElement("span",{style:{whiteSpace:"pre-wrap"}},this.props.message))}}]),a}(s.a.Component)),v=d()("/"),b=s.a.createElement("div",{style:{margin:"auto",padding:"10px"}},"Tap ",s.a.createElement("span",{className:"material-icons"},"add_circle")," button to add friends and start chatting.",s.a.createElement("br",null),s.a.createElement("br",null),"Use ",s.a.createElement("strong",null,"@someone message-text")," to send messages"),y=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={name:"",pop:"none",fpop:"none",friends:[],messages:[],last:"",loading:!0,filter:"All"},n.send=n.send.bind(Object(c.a)(n)),n.add=n.add.bind(Object(c.a)(n)),n.type=n.type.bind(Object(c.a)(n)),n.filter=n.filter.bind(Object(c.a)(n)),n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;h.a.ajax({method:"post",url:"/check",data:{token:localStorage.getItem("token")},success:function(t){t.verified?(e.setState({name:t.name}),v.emit("join",{name:e.state.name})):(localStorage.removeItem("token"),e.props.login(!1))},error:function(e){}}),h.a.post("/fetch",{token:localStorage.getItem("token")},(function(t){t.error;var a=[];t.map((function(t){t.from==e.state.name||a.includes(t.from)||a.push(t.from),t.to==e.state.name||a.includes(t.to)||a.push(t.to)}));e.setState({messages:t,friends:a,last:a[a.length-1]}),0==t.length?e.setState({welcome:b}):e.setState({welcome:s.a.createElement("div",null)})})),v.on("msg",(function(t){e.setState({messages:e.state.messages.concat(t)}),e.state.friends.includes(t.from)||e.setState({friends:e.state.friends.concat(t.from)}),e.setState({last:t.from})})),h()(".main").scrollTop(h()(".main")[0].scrollHeight),h()(".material-icons").on("mousedown",(function(){return!1})),h()(".material-icons").on("selectstart",(function(){return!1}))}},{key:"componentDidUpdate",value:function(){this.state.welcome==b&&this.state.messages.length>0&&this.setState({welcome:s.a.createElement("div",null)}),h()(".main").scrollTop(h()(".main")[0].scrollHeight)}},{key:"componentWillUnmount",value:function(){v.disconnect()}},{key:"add",value:function(){var e=this,t=h()(".add > input").val();h.a.post("/usr",{usr:t},(function(a){a?(e.state.friends.find((function(e){return e==t}))||e.setState({friends:e.state.friends.concat(t),last:t}),e.setState({adderr:s.a.createElement("strong",null,"User added successfully",s.a.createElement("br",null),"You can use ",s.a.createElement("em",null,"@",t)," to chat with ",s.a.createElement("em",null,t," "))})):e.setState({adderr:s.a.createElement("strong",null,"User not found")})}))}},{key:"type",value:function(e){if(e.target.value){var t=this.state.friends;e.target.value&&"@"!=e.target.value[0]&&(e.target.value="@"+this.state.last+" "+e.target.value);var a=t.filter((function(t){return t.substr(0,e.target.value.length-1)==e.target.value.substr(1)}));this.setState({results:a})}else this.setState({results:[]})}},{key:"send",value:function(){var e=this;if(h()("#mess").val()){var t=h()("#mess").val().split(" ")[0].substr(1),a=h()("#mess").val().split(" ").slice(1).join(" ");if(!this.state.friends.find((function(e){return e==t})))return this.setState({inv_usr:!0}),void setTimeout((function(){e.setState({inv_usr:!1})}),1500);var n={token:localStorage.getItem("token"),dta:{from:this.state.name,to:t,message:a,time:Date.now()}};this.setState({messages:this.state.messages.concat(n.dta),last:t}),h()("#mess").val(""),h.a.post("/send",n,(function(e){e.error}))}}},{key:"filter",value:function(){var e=this;""==h()("#filter input").val()?this.setState({filter:"All",fpop:"none"}):"All"==h()("#filter input").val()||this.state.friends.includes(h()("#filter input").val())?this.setState({filter:h()("#filter input").val(),fpop:"none"}):(this.setState({inv_usr:!0,fpop:"none"}),setTimeout((function(){return e.setState({inv_usr:!1})}),1500))}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{id:"rooot"},s.a.createElement("div",{className:"chatwin"},s.a.createElement("div",{className:"top"},s.a.createElement("span",{style:{margin:"10px",flex:"10",fontFamily:"'Poppins', sans-serif",fontWeight:"400",fontSize:"1.2em",maxWidth:"70%",overflowX:"hidden"}},this.state.name),s.a.createElement("span",{className:"material-icons",style:{margin:"10px ",flex:"1",cursor:"pointer",fontSize:"1.8em",fontWeight:"200"},onClick:function(){localStorage.removeItem("token"),e.props.login(!1)}},"power_settings_new"),s.a.createElement("span",{className:"material-icons",style:{margin:"10px",flex:"1",cursor:"pointer",fontWeight:"200",fontSize:"1.8em"},onClick:function(){"none"==e.state.pop&&e.setState({fpop:"none"==e.state.fpop?"flex":"none"})}}," filter_list "),s.a.createElement("span",{className:"material-icons",style:{margin:"10px",flex:"1",cursor:"pointer",fontWeight:"200",fontSize:"1.8em"},onClick:function(){"none"==e.state.fpop&&e.setState({pop:"none"==e.state.pop?"flex":"none",adderr:""})}}," add_circle "),s.a.createElement("span",{className:"material-icons ",style:{margin:"10px",flex:"1",cursor:"pointer",fontWeight:"200",fontSize:"1.8em"},onClick:function(){return h()(".main").scrollTop(h()(".main")[0].scrollHeight)}}," keyboard_arrow_down ")),s.a.createElement("div",{className:"main"},s.a.createElement("div",{className:"add",style:{display:this.state.pop}},s.a.createElement("input",{type:"text",placeholder:"Search for users",className:"inp",style:{flex:"3",marginBottom:"10px"}}),s.a.createElement("button",{className:"button",onClick:this.add,style:{flex:"1"}},"Add"),this.state.adderr&&s.a.createElement("span",{style:{width:"100%",margin:"10px"}},this.state.adderr)),s.a.createElement("div",{id:"filter",className:"add",style:{display:this.state.fpop}},s.a.createElement("datalist",{id:"ffriends"},s.a.createElement("option",{value:"All"}),this.state.friends.map((function(e){return s.a.createElement("option",{value:e})}))),s.a.createElement("input",{type:"search",list:"ffriends",placeholder:"Search for users",className:"inp",style:{flex:"3",marginBottom:"10px"}}),s.a.createElement("button",{className:"button",onClick:this.filter,style:{flex:"1"}},"Filter")),this.state.welcome,!this.state.welcome&&s.a.createElement("div",{style:{margin:"auto"}},"Getting Messages ..."),this.state.messages.map((function(t){return s.a.createElement(g,{name:e.state.name==t.from?t.to:t.from,type:e.state.name==t.from?"sen":"rec",time:t.time,message:t.message,filter:e.state.filter})}))),s.a.createElement("div",{className:"suggestions"},this.state.results&&this.state.results.map((function(t){return s.a.createElement("div",{onClick:function(){h()("#mess").val("@"+t+" "),h()("#mess").focus(),e.setState({results:[]})}},"@"+t)}))),this.state.last&&s.a.createElement("div",{className:"bottom"},this.state.inv_usr&&s.a.createElement("span",{style:{width:"100%",padding:"10px 0px",color:"red"}},"Invalid User"),s.a.createElement("textarea",{className:"inp",id:"mess",placeholder:"@"+this.state.last+" ",style:{flex:"1",paddingTop:"8px",boxSizing:"border-box",minHeight:"40px"},onInput:this.type}),s.a.createElement("button",{id:"send",className:"button",style:{width:"auto",height:"40px",minWidth:"60px",float:"right",fontFamily:"'Open Sans',sans-serif",fontWeight:"700",fontSize:"1.8em"},onClick:this.send},s.a.createElement("span",{className:"material-icons large"},"send")))))}}]),a}(s.a.Component),E=a(58),S=a.n(E),x=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){var e;return Object(l.a)(this,a),(e=t.call(this)).state={login:!0,error:""},e}return Object(o.a)(a,[{key:"tabsw",value:function(e){"Login"==e.target.innerText?this.setState({login:!0,error:""}):this.setState({login:!1,error:""})}},{key:"login",value:function(e){var t=this;e.preventDefault(),h()(".button").prop("disabled",!0),h.a.ajax({method:"post",url:"/login",data:{name:h()("#un").val().trim().replace(" ","_"),pwd:S()(h()("#pwd").val()).toString()},success:function(e){e.token?(localStorage.setItem("token",e.token),t.props.login(!0)):(t.setState({error:e.error}),h()(".button").prop("disabled",!1))}})}},{key:"signup",value:function(e){var t=this;e.preventDefault(),h()("#pwds").val()==h()("#pwdc").val()?(h()(".button").prop("disabled",!0),h.a.ajax({method:"post",url:"/signup",data:{name:h()("#uns").val().trim().replace(" ","_"),pwd:S()(h()("#pwds").val()).toString()},success:function(e){e.error?(t.setState({error:"user already exists"}),h()(".button").prop("disabled",!1)):(localStorage.setItem("token",e.token),t.props.login(!0))}})):this.setState({error:"Passwords don't match"})}},{key:"render",value:function(){var e,t=this;return e=this.state.login?s.a.createElement("form",{className:"inner",onSubmit:function(e){return t.login(e)}},s.a.createElement("input",{name:"name",type:"text",id:"un",className:"inp",placeholder:"Username",required:!0,style:{marginTop:"10px"}}),s.a.createElement("input",{name:"name",type:"password",id:"pwd",className:"inp",placeholder:"Password",required:!0,style:{marginTop:"10px"}}),s.a.createElement("input",{type:"submit",className:"button",value:"Login",style:{width:"40%",minWidth:"150px",alignSelf:"center",marginTop:"20px"}})):s.a.createElement("form",{className:"inner",onSubmit:function(e){return t.signup(e)}},s.a.createElement("input",{name:"names",type:"text",id:"uns",className:"inp",placeholder:"Username",required:!0,style:{marginTop:"10px"}}),s.a.createElement("input",{name:"pwds",type:"password",id:"pwds",className:"inp",placeholder:"Password",required:!0,style:{marginTop:"10px"}}),s.a.createElement("span",null),s.a.createElement("input",{name:"pwdc",type:"password",id:"pwdc",className:"inp",placeholder:"Confirm Password",required:!0,style:{marginTop:"10px"}}),s.a.createElement("input",{type:"submit",className:"button",value:"Create Account",style:{width:"60%",minWidth:"200px",alignSelf:"center",marginTop:"20px"}})),s.a.createElement("div",{id:"rooot"},s.a.createElement("div",{className:"code material-icons",onClick:function(){return window.open("https://github.com/harivikneshs/superchat","_blank")}},"code"),s.a.createElement("div",{className:"header"},s.a.createElement("span",{style:{backgroundColor:"white"}},"Super Chat")),s.a.createElement("div",{className:"lcard"},s.a.createElement("div",{className:"tabs"},s.a.createElement("span",{className:this.state.login?"tab active":"tab",onClick:function(e){return t.tabsw(e)}},"Login"),s.a.createElement("span",{className:this.state.login?"tab":"tab active",onClick:function(e){return t.tabsw(e)}},"Sign Up")),e,this.state.error&&s.a.createElement("div",{style:{margin:"10px",color:"red"}},this.state.error)))}}]),a}(s.a.Component),k=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){var e;return Object(l.a)(this,a),(e=t.call(this)).state={isAuth:!!localStorage.getItem("token")},e.login=e.login.bind(Object(c.a)(e)),e}return Object(o.a)(a,[{key:"login",value:function(e){this.setState({isAuth:e})}},{key:"render",value:function(){var e;return e=this.state.isAuth?s.a.createElement(y,{login:this.login}):s.a.createElement(x,{login:this.login}),s.a.createElement("div",null,e)}}]),a}(s.a.Component);r.a.render(s.a.createElement(k,null),document.getElementById("root"))},41:function(e,t,a){}},[[111,1,2]]]);
//# sourceMappingURL=main.4288ead4.chunk.js.map